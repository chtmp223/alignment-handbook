Removing miniconda version 22.11.1-1
Loading miniconda version 22.11.1-1
loading libiconv version 1.16
loading xz version 5.2.5
loading zlib version 1.2.11
loading libxml2 version 2.9.12
loading cuda version 11.8.0
Retrieving notices: ...working... done
Collect all metadata (repodata.json): ...working... done
Solving environment: ...working... done

## Package Plan ##

  environment location: /home/ctpham_umass_edu/.conda/envs/prolong



Proceed ([y]/n)? 
Preparing transaction: ...working... done
Verifying transaction: ...working... done
Executing transaction: ...working... done
#
# To activate this environment, use
#
#     $ conda activate prolong
#
# To deactivate an active environment, use
#
#     $ conda deactivate

Defaulting to user installation because normal site-packages is not writeable
WARNING: Ignoring invalid distribution ~orch (/home/ctpham_umass_edu/.local/lib/python3.11/site-packages)
Collecting wheel
  Using cached wheel-0.44.0-py3-none-any.whl.metadata (2.3 kB)
Requirement already satisfied: packaging in /home/ctpham_umass_edu/.local/lib/python3.11/site-packages (24.1)
Collecting deepspeed
  Using cached deepspeed-0.15.1-py3-none-any.whl
Requirement already satisfied: hjson in /home/ctpham_umass_edu/.local/lib/python3.11/site-packages (from deepspeed) (3.1.0)
Requirement already satisfied: ninja in /home/ctpham_umass_edu/.local/lib/python3.11/site-packages (from deepspeed) (1.11.1.1)
Requirement already satisfied: numpy in /home/ctpham_umass_edu/.local/lib/python3.11/site-packages (from deepspeed) (2.1.1)
Requirement already satisfied: psutil in /home/ctpham_umass_edu/.local/lib/python3.11/site-packages (from deepspeed) (6.0.0)
Requirement already satisfied: py-cpuinfo in /home/ctpham_umass_edu/.local/lib/python3.11/site-packages (from deepspeed) (9.0.0)
Requirement already satisfied: pydantic>=2.0.0 in /home/ctpham_umass_edu/.local/lib/python3.11/site-packages (from deepspeed) (2.9.2)
Collecting torch (from deepspeed)
  Using cached torch-2.4.1-cp311-cp311-manylinux1_x86_64.whl.metadata (26 kB)
Requirement already satisfied: tqdm in /home/ctpham_umass_edu/.local/lib/python3.11/site-packages (from deepspeed) (4.66.5)
Collecting nvidia-ml-py (from deepspeed)
  Using cached nvidia_ml_py-12.560.30-py3-none-any.whl.metadata (8.6 kB)
Requirement already satisfied: annotated-types>=0.6.0 in /home/ctpham_umass_edu/.local/lib/python3.11/site-packages (from pydantic>=2.0.0->deepspeed) (0.7.0)
Requirement already satisfied: pydantic-core==2.23.4 in /home/ctpham_umass_edu/.local/lib/python3.11/site-packages (from pydantic>=2.0.0->deepspeed) (2.23.4)
Requirement already satisfied: typing-extensions>=4.6.1 in /home/ctpham_umass_edu/.local/lib/python3.11/site-packages (from pydantic>=2.0.0->deepspeed) (4.12.2)
Requirement already satisfied: filelock in /home/ctpham_umass_edu/.local/lib/python3.11/site-packages (from torch->deepspeed) (3.16.1)
Collecting sympy (from torch->deepspeed)
  Using cached sympy-1.13.3-py3-none-any.whl.metadata (12 kB)
Collecting networkx (from torch->deepspeed)
  Using cached networkx-3.3-py3-none-any.whl.metadata (5.1 kB)
Requirement already satisfied: jinja2 in /home/ctpham_umass_edu/.local/lib/python3.11/site-packages (from torch->deepspeed) (3.1.4)
Requirement already satisfied: fsspec in /home/ctpham_umass_edu/.local/lib/python3.11/site-packages (from torch->deepspeed) (2024.9.0)
Collecting nvidia-cuda-nvrtc-cu12==12.1.105 (from torch->deepspeed)
  Using cached nvidia_cuda_nvrtc_cu12-12.1.105-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)
Collecting nvidia-cuda-runtime-cu12==12.1.105 (from torch->deepspeed)
  Using cached nvidia_cuda_runtime_cu12-12.1.105-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)
Collecting nvidia-cuda-cupti-cu12==12.1.105 (from torch->deepspeed)
  Using cached nvidia_cuda_cupti_cu12-12.1.105-py3-none-manylinux1_x86_64.whl.metadata (1.6 kB)
Collecting nvidia-cudnn-cu12==9.1.0.70 (from torch->deepspeed)
  Using cached nvidia_cudnn_cu12-9.1.0.70-py3-none-manylinux2014_x86_64.whl.metadata (1.6 kB)
Collecting nvidia-cublas-cu12==12.1.3.1 (from torch->deepspeed)
  Using cached nvidia_cublas_cu12-12.1.3.1-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)
Collecting nvidia-cufft-cu12==11.0.2.54 (from torch->deepspeed)
  Using cached nvidia_cufft_cu12-11.0.2.54-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)
Collecting nvidia-curand-cu12==10.3.2.106 (from torch->deepspeed)
  Using cached nvidia_curand_cu12-10.3.2.106-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)
Collecting nvidia-cusolver-cu12==11.4.5.107 (from torch->deepspeed)
  Using cached nvidia_cusolver_cu12-11.4.5.107-py3-none-manylinux1_x86_64.whl.metadata (1.6 kB)
Collecting nvidia-cusparse-cu12==12.1.0.106 (from torch->deepspeed)
  Using cached nvidia_cusparse_cu12-12.1.0.106-py3-none-manylinux1_x86_64.whl.metadata (1.6 kB)
Collecting nvidia-nccl-cu12==2.20.5 (from torch->deepspeed)
  Using cached nvidia_nccl_cu12-2.20.5-py3-none-manylinux2014_x86_64.whl.metadata (1.8 kB)
Collecting nvidia-nvtx-cu12==12.1.105 (from torch->deepspeed)
  Using cached nvidia_nvtx_cu12-12.1.105-py3-none-manylinux1_x86_64.whl.metadata (1.7 kB)
Collecting triton==3.0.0 (from torch->deepspeed)
  Using cached triton-3.0.0-1-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (1.3 kB)
Collecting nvidia-nvjitlink-cu12 (from nvidia-cusolver-cu12==11.4.5.107->torch->deepspeed)
  Using cached nvidia_nvjitlink_cu12-12.6.68-py3-none-manylinux2014_x86_64.whl.metadata (1.5 kB)
Requirement already satisfied: MarkupSafe>=2.0 in /home/ctpham_umass_edu/.local/lib/python3.11/site-packages (from jinja2->torch->deepspeed) (2.1.5)
Collecting mpmath<1.4,>=1.1.0 (from sympy->torch->deepspeed)
  Using cached mpmath-1.3.0-py3-none-any.whl.metadata (8.6 kB)
Using cached wheel-0.44.0-py3-none-any.whl (67 kB)
Using cached nvidia_ml_py-12.560.30-py3-none-any.whl (40 kB)
Using cached torch-2.4.1-cp311-cp311-manylinux1_x86_64.whl (797.1 MB)
Using cached nvidia_cublas_cu12-12.1.3.1-py3-none-manylinux1_x86_64.whl (410.6 MB)
Using cached nvidia_cuda_cupti_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (14.1 MB)
Using cached nvidia_cuda_nvrtc_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (23.7 MB)
Using cached nvidia_cuda_runtime_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (823 kB)
Using cached nvidia_cudnn_cu12-9.1.0.70-py3-none-manylinux2014_x86_64.whl (664.8 MB)
Using cached nvidia_cufft_cu12-11.0.2.54-py3-none-manylinux1_x86_64.whl (121.6 MB)
Using cached nvidia_curand_cu12-10.3.2.106-py3-none-manylinux1_x86_64.whl (56.5 MB)
Using cached nvidia_cusolver_cu12-11.4.5.107-py3-none-manylinux1_x86_64.whl (124.2 MB)
Using cached nvidia_cusparse_cu12-12.1.0.106-py3-none-manylinux1_x86_64.whl (196.0 MB)
Using cached nvidia_nccl_cu12-2.20.5-py3-none-manylinux2014_x86_64.whl (176.2 MB)
Using cached nvidia_nvtx_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (99 kB)
Using cached triton-3.0.0-1-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (209.4 MB)
Using cached networkx-3.3-py3-none-any.whl (1.7 MB)
Using cached sympy-1.13.3-py3-none-any.whl (6.2 MB)
Using cached mpmath-1.3.0-py3-none-any.whl (536 kB)
Using cached nvidia_nvjitlink_cu12-12.6.68-py3-none-manylinux2014_x86_64.whl (19.7 MB)
WARNING: Ignoring invalid distribution ~orch (/home/ctpham_umass_edu/.local/lib/python3.11/site-packages)
Installing collected packages: nvidia-ml-py, mpmath, wheel, triton, sympy, nvidia-nvtx-cu12, nvidia-nvjitlink-cu12, nvidia-nccl-cu12, nvidia-curand-cu12, nvidia-cufft-cu12, nvidia-cuda-runtime-cu12, nvidia-cuda-nvrtc-cu12, nvidia-cuda-cupti-cu12, nvidia-cublas-cu12, networkx, nvidia-cusparse-cu12, nvidia-cudnn-cu12, nvidia-cusolver-cu12, torch, deepspeed
WARNING: Ignoring invalid distribution ~orch (/home/ctpham_umass_edu/.local/lib/python3.11/site-packages)
ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
tensorflow 2.16.1 requires numpy<2.0.0,>=1.23.5; python_version <= "3.11", but you have numpy 2.1.1 which is incompatible.
tensorflow 2.16.1 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.3, but you have protobuf 5.28.2 which is incompatible.
Successfully installed deepspeed-0.15.1 mpmath-1.3.0 networkx-3.3 nvidia-cublas-cu12-12.1.3.1 nvidia-cuda-cupti-cu12-12.1.105 nvidia-cuda-nvrtc-cu12-12.1.105 nvidia-cuda-runtime-cu12-12.1.105 nvidia-cudnn-cu12-9.1.0.70 nvidia-cufft-cu12-11.0.2.54 nvidia-curand-cu12-10.3.2.106 nvidia-cusolver-cu12-11.4.5.107 nvidia-cusparse-cu12-12.1.0.106 nvidia-ml-py-12.560.30 nvidia-nccl-cu12-2.20.5 nvidia-nvjitlink-cu12-12.6.68 nvidia-nvtx-cu12-12.1.105 sympy-1.13.3 torch-2.4.1 triton-3.0.0 wheel-0.44.0
Defaulting to user installation because normal site-packages is not writeable
ERROR: Could not open requirements file: [Errno 2] No such file or directory: 'mosaic-req.txt'
/var/spool/slurm/slurmd/job25028697/slurm_script: line 22: cd: ../data_tools/: No such file or directory
python3: can't open file 'mds_tokenize_per_document.py': [Errno 2] No such file or directory
python3: can't open file 'mds_pack_data.py': [Errno 2] No such file or directory
python3: can't open file 'mds_merge.py': [Errno 2] No such file or directory
/var/spool/slurm/slurmd/job25028697/slurm_script: line 110: accelerate: command not found
